<!--


‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñë‚ñë
‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ïö‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë
‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ïö‚ïù‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë
‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ïö‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë
‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñë‚ñë‚ñë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ñë‚ñë‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë‚ñë‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ñë‚ñë‚ñë‚ñë‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù


ùî∏ùï¶ùï•ùïñùï¶ùï£ : Elias Zaiem
ùîªùïíùï•ùïñ : 18.05.2022
‚Ñôùï£ùï†ùïõùïñùï• : TPI Elias Zaiem Mai-2022
‚Ñôùï£ùï†ùïó ùîªùïñ ùïã‚ÑôùïÄ : Mr.Garchery
‚ÑÇùïùùïíùï§ùï§ùïñ : I.DA-P4A
-->
<?php
// Controlleur admin

$action = filter_input(INPUT_GET, 'action');
switch ($action) {
        //Visuel de la page de gestion des cat√©gories
    case 'ShowCategorieAdminPannel':
        include 'vue/adminPannel.php';
        break;

        //Visuel de la page de gestion des utilisateurs (isAdmin)
    case 'ShowUserAdminPannel':
        include 'vue/gestionUserAdmin.php';
        break;

        //Affiche la page de modification de la cat√©gorie s√©lectionn√©e.
    case 'ShowEditCategorie':
        include 'vue/editCategorie.php';
        break;

        //Changements des droits de l'utilisateur
    case 'changeAdminRights':
        $idUser = filter_input(INPUT_GET, 'idUser', FILTER_SANITIZE_NUMBER_INT);
        $username;
        $checkboxAdmin = filter_input(INPUT_POST, 'isAdmin');
        if ($checkboxAdmin != null) {
            User::UpdateUserRole($idUser, 2);
            $_SESSION['AlertMessage'] = [
                'type' => "success",
                'message' => "Les droits d'administrateur ont bien √©t√©s donn√©s"
            ];
        } else {
            User::UpdateUserRole($idUser, 1);
            $_SESSION['AlertMessage'] = [
                'type' => "success",
                'message' => "Les droits ont √©t√© retir√©s"
            ];
        }

        //header('Location: index.php?uc=admin&action=ShowUserAdminPannel');
        echo '<script>window.location.href = "index.php?uc=admin&action=ShowUserAdminPannel";</script>';
        break;

        //Suppression d'une cat√©gorie depuis la page admin
    case 'deleteCategorie':
        $idCategorie = filter_input(INPUT_GET, 'idCategorie', FILTER_SANITIZE_NUMBER_INT);
        $nom = Categorie::GetCategorieNameById($idCategorie);
        Production::RemoveCategorie($idCategorie);
        Categorie::DeleteCategorie($idCategorie);
        //Une fois la cat√©gorie supprim√©e, un message de r√©ussite s'affiche
        $_SESSION['AlertMessage'] = [
            'type' => "success",
            'message' => "La Cat√©gorie " . $nom . " a bien √©t√© supprim√© de la base de donn√©es."
        ];
        //Redirige l'administrateur sur la page de gestion
        //header('Location: index.php?uc=admin&action=ShowCategorieAdminPannel');
        echo '<script>window.location.href = "index.php?uc=admin&action=ShowCategorieAdminPannel";</script>';
        break;

        //Ajoute une cat√©gorie dans la base de donn√©es
    case 'AddCategorie':
        $CategorieName = filter_input(INPUT_POST, 'nomCategorie', FILTER_SANITIZE_STRING);
        //Appel de la fonction d'ajout
        Categorie::AddNewCategorie($CategorieName);
        //Message de r√©ussie
        $_SESSION['AlertMessage'] = [
            'type' => "success",
            'message' => "La nouvelle cat√©gorie " . $CategorieName . " a bien √©t√© ajout√© dans la base de donn√©es."
        ];
        //Redirection de l'administrateur
        //header('Location: index.php?uc=admin&action=ShowCategorieAdminPannel');
        echo '<script>window.location.href = "index.php?uc=admin&action=ShowCategorieAdminPannel";</script>';
        break;

        //Met √† jour une cat√©gorie (modification du nom de la cat√©gorie)
    case 'UpdateCategorie':
        $idCategorie = filter_input(INPUT_GET, 'idCategorie', FILTER_SANITIZE_NUMBER_INT);
        $nomCategorie = filter_input(INPUT_POST, 'nomCategorie', FILTER_SANITIZE_STRING);
        //Appel de la fonction de modification
        Categorie::UpdateCategorie($idCategorie, $nomCategorie);
        //Message de r√©ussie
        $_SESSION['AlertMessage'] = [
            'type' => "success",
            'message' => "La cat√©gorie " . $nomCategorie . " a bien √©t√© modifi√© dans la base de donn√©es."
        ];
        //Redirection de l'administrateur
        //header('Location: index.php?uc=admin&action=ShowCategorieAdminPannel');
        echo '<script>window.location.href = "index.php?uc=admin&action=ShowCategorieAdminPannel";</script>';
        break;

        //Page par d√©faut si il y a une erreur lors du chargement des autres pages.
    default:
        include 'vue/erreur404.php';
        break;
}
